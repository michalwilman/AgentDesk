# ××“×¨×™×š ×”×ª×§× ×” ××”×™×¨ - OAuth ×•-PayPal

## ğŸ¯ ×¡×™×›×•× ××” ×©×”×ª×•×•×¡×£

### ×¢××•×“×™× ×—×“×©×™×:
1. âœ… ×¢××•×“ ×”×¨×©××” ××©×•×“×¨×’ ×¢× Google ×•-Facebook OAuth
2. âœ… ×¢××•×“ ×ª×©×œ×•× (`/checkout`) ×¢× PayPal ×××™×ª×™
3. âœ… ×¢××•×“ ×”×¦×œ×—×” (`/checkout/success`)
4. âœ… ×¢××•×“ ×‘×™×˜×•×œ (`/checkout/cancel`)

### ×‘×¡×™×¡ × ×ª×•× ×™×:
- âœ… ×˜×‘×œ×ª `transactions` ×—×“×©×” ×œ×©××™×¨×ª ×¤×¨×˜×™ ×ª×©×œ×•××™×

---

## âš¡ ×”×ª×§× ×” ××”×™×¨×” - 3 ×©×œ×‘×™×

### ×©×œ×‘ 1: ×”×’×“×¨×ª ××©×ª× ×™ ×¡×‘×™×‘×”

×¦×•×¨ ×§×•×‘×¥ `frontend/.env.local`:

```bash
# Supabase (×§×™×™×)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# PayPal Sandbox (×—×“×©)
NEXT_PUBLIC_PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_SECRET=your_paypal_secret
```

### ×©×œ×‘ 2: ×”×¨×¦×ª Schema ×‘×‘×¡×™×¡ ×”× ×ª×•× ×™×

1. ×¢×‘×•×¨ ×œ-Supabase Dashboard
2. ×œ×—×¥ ×¢×œ SQL Editor
3. ×”×¨×¥ ××ª ×”×§×•×“ ×”×‘×:

```sql
-- ×˜×‘×œ×ª ×ª×©×œ×•××™×
CREATE TABLE transactions (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES users(id) ON DELETE SET NULL,
  plan VARCHAR(50) NOT NULL,
  amount NUMERIC(10,2) NOT NULL,
  currency VARCHAR(3) DEFAULT 'ILS',
  status VARCHAR(20) NOT NULL DEFAULT 'pending',
  paypal_order_id TEXT,
  full_name VARCHAR(255),
  email VARCHAR(255),
  metadata JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ××™× ×“×§×¡×™×
CREATE INDEX idx_transactions_user_id ON transactions(user_id);
CREATE INDEX idx_transactions_status ON transactions(status);
CREATE INDEX idx_transactions_created_at ON transactions(created_at);

-- RLS
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own transactions" ON transactions
  FOR SELECT USING (auth.uid() = user_id);

CREATE POLICY "Users can create own transactions" ON transactions
  FOR INSERT WITH CHECK (auth.uid() = user_id);
```

### ×©×œ×‘ 3: ×”×¤×¢×œ×ª ×”×©×¨×ª

```bash
cd frontend
npm run dev
```

×¢×›×©×™×• ×’×© ×œ-`http://localhost:3000/register` ×•×ª×¨××” ××ª ×›×¤×ª×•×¨×™ ×”-OAuth!

---

## ğŸ”‘ ×”×•×¦××ª ××¤×ª×—×•×ª API

### Google OAuth

1. **Google Cloud Console**: https://console.cloud.google.com/
2. ×¦×•×¨ ×¤×¨×•×™×§×˜ ×—×“×©
3. ×”×¤×¢×œ Google+ API
4. ×¦×•×¨ OAuth Client ID
5. ×”×•×¡×£ Redirect URI: `https://YOUR-PROJECT.supabase.co/auth/v1/callback`
6. ×”×¢×ª×§ Client ID ×•-Secret
7. ×”×“×‘×§ ×‘-Supabase â†’ Authentication â†’ Providers â†’ Google

### Facebook OAuth

1. **Facebook Developers**: https://developers.facebook.com/
2. ×¦×•×¨ ××¤×œ×™×§×¦×™×” ×—×“×©×” (Consumer)
3. ×”×•×¡×£ Facebook Login
4. ×”×•×¡×£ Redirect URI: `https://YOUR-PROJECT.supabase.co/auth/v1/callback`
5. ×”×¢×ª×§ App ID ×•-Secret
6. ×”×“×‘×§ ×‘-Supabase â†’ Authentication â†’ Providers â†’ Facebook

### PayPal Sandbox

1. **PayPal Developer**: https://developer.paypal.com/
2. ×¢×‘×•×¨ ×œ-Apps & Credentials
3. ×•×“× ×©××ª×” ×‘××¦×‘ **Sandbox** (×œ××¢×œ×”)
4. ×œ×—×¥ Create App
5. ×”×¢×ª×§ Client ID ×•-Secret
6. ×”×“×‘×§ ×‘-`frontend/.env.local`

---

## ğŸ§ª ×‘×“×™×§×ª ×”××¢×¨×›×ª

### ×‘×“×™×§×ª OAuth:

```
1. ×’×© ×œ-http://localhost:3000/register
2. ×œ×—×¥ ×¢×œ "Continue with Google"
3. ×”×ª×—×‘×¨ ×¢× ×—×©×‘×•×Ÿ Google
4. ×××•×¨ ×œ×”×™×•×ª ××•×¢×‘×¨ ×—×–×¨×” ×•××—×•×‘×¨ âœ…
```

### ×‘×“×™×§×ª PayPal:

```
1. ×’×© ×œ-http://localhost:3000/pricing
2. ×œ×—×¥ "Get Started" ×¢×œ Pro
3. ×ª×•×¢×‘×¨ ×œ×¢××•×“ ×ª×©×œ×•×
4. ×œ×—×¥ ×¢×œ ×›×¤×ª×•×¨ PayPal
5. ×”×ª×—×‘×¨ ×¢× ×—×©×‘×•×Ÿ Sandbox (×-PayPal Developer)
6. ××©×¨ ×ª×©×œ×•×
7. ×ª×•×¢×‘×¨ ×œ×¢××•×“ ×”×¦×œ×—×” âœ…
```

**××™×¤×” ×œ××¦×•× ×—×©×‘×•×Ÿ Sandbox?**
- PayPal Developer â†’ Sandbox â†’ Accounts
- ×”×©×ª××© ×‘-Personal Account ×œ×‘×“×™×§×•×ª

---

## ğŸ“‚ ××‘× ×” ×”×§×‘×¦×™× ×”×—×“×©×™×

```
frontend/
  â”œâ”€â”€ app/
  â”‚   â”œâ”€â”€ (auth)/
  â”‚   â”‚   â””â”€â”€ register/
  â”‚   â”‚       â””â”€â”€ page.tsx â† ×¢×•×“×›×Ÿ ×¢× OAuth
  â”‚   â”œâ”€â”€ checkout/
  â”‚   â”‚   â”œâ”€â”€ page.tsx â† ×—×“×©! ×¢××•×“ ×ª×©×œ×•×
  â”‚   â”‚   â”œâ”€â”€ success/
  â”‚   â”‚   â”‚   â””â”€â”€ page.tsx â† ×—×“×©! ×¢××•×“ ×”×¦×œ×—×”
  â”‚   â”‚   â””â”€â”€ cancel/
  â”‚   â”‚       â””â”€â”€ page.tsx â† ×—×“×©! ×¢××•×“ ×‘×™×˜×•×œ
  â”‚   â””â”€â”€ pricing/
  â”‚       â””â”€â”€ page.tsx â† ×¢×•×“×›×Ÿ ×¢× ×§×™×©×•×¨×™× ×—×“×©×™×
  â””â”€â”€ package.json â† ×¢×•×“×›×Ÿ ×¢× PayPal SDK

supabase/
  â””â”€â”€ schema.sql â† ×˜×‘×œ×ª transactions ×—×“×©×”
```

---

## ğŸ¨ ××” ×©××•×¨ ×¢×œ ×”×¢×™×¦×•×‘

×›×œ ×”×¢××•×“×™× ×”×—×“×©×™× ×©×•××¨×™× ×¢×œ ×”×¢×™×¦×•×‘ ×©×œ AgentDesk:

- ğŸ¨ ×¨×§×¢ ×›×”×”: `#0D0D0D`
- ğŸ’š ×˜×•×¨×§×™×–: `#00E0C6`
- âœ¨ ××¤×§×˜×™ ×–×•×”×¨ (glow)
- ğŸ”„ ××¢×‘×¨×™ ×× ×™××¦×™×” ×—×œ×§×™×
- ğŸ“± ×¨×¡×¤×•× ×¡×™×‘×™ ××œ×
- ğŸŒ ×ª××™×›×” ×‘-RTL

---

## ğŸ”„ ×ª×¨×©×™× ×–×¨×™××”

```
×¢××•×“ ××—×™×¨×™×
    â†“
Pro/Business â†’ /checkout?plan=pro
    â†“
×¢××•×“ ×ª×©×œ×•× (PayPal)
    â†“
×ª×©×œ×•× ×”×•×©×œ×? 
    â†“           â†“
   ×›×Ÿ          ×œ×
    â†“           â†“
× ×©××¨ ×‘DB     /cancel
    â†“
/success
```

---

## ğŸ›¡ï¸ ××‘×˜×—×”

- âœ… ×¡×•×“×•×ª OAuth ×‘-Supabase (×œ× ×‘×§×•×“)
- âœ… PayPal Secret ×©×¨×ª ×‘×œ×‘×“
- âœ… RLS ×××•×‘×˜×—
- âœ… Sandbox ×œ××‘×—× ×™× ×‘×œ×‘×“

---

## ğŸ“ ×§×‘×œ×ª ×¢×–×¨×”

××¡××›×™× ××¤×•×¨×˜×™× ×‘×× ×’×œ×™×ª:
- `OAUTH_PAYPAL_SETUP.md` - ×”×“×¨×›×” ××œ××” ×¢× ×¦×™×œ×•××™ ××¡×š
- `IMPLEMENTATION_SUMMARY.md` - ×¡×™×›×•× ×˜×›× ×™ ××œ×

---

## âœ… ×¦'×§×œ×™×¡×˜ ×¡×•×¤×™

- [ ] ×”×•×¡×¤×ª ××©×ª× ×™ PayPal ×œ-.env.local
- [ ] ×”×¨×¦×ª Schema ×©×œ transactions ×‘-Supabase
- [ ] ×”×’×“×¨×ª Google OAuth ×‘-Supabase
- [ ] ×”×’×“×¨×ª Facebook OAuth ×‘-Supabase
- [ ] ×‘×“×™×§×ª ×”×ª×—×‘×¨×•×ª ×¢× Google
- [ ] ×‘×“×™×§×ª ×”×ª×—×‘×¨×•×ª ×¢× Facebook
- [ ] ×‘×“×™×§×ª ×ª×©×œ×•× PayPal Sandbox
- [ ] ×•×™×“×•× ×©×”×ª×©×œ×•× × ×©××¨ ×‘-DB

---

## ğŸš€ ××•×›×Ÿ ×œ×¢×‘×•×“×”!

**×”×›×œ ××•×›×Ÿ ×•××•×ª×§×Ÿ.**  
**×¨×§ ×¦×¨×™×š ×œ×”×’×“×™×¨ ××ª ×”××¤×ª×—×•×ª ×•×œ×”×¨×™×¥!**

×‘×”×¦×œ×—×”! ğŸ’ª

